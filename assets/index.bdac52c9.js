var D=Object.defineProperty;var S=(d,e,t)=>e in d?D(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t;var r=(d,e,t)=>(S(d,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const p=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];class L{constructor(e){r(this,"cardNum");this.cardNum=e}score(){if(this.cardNum==="A")return{score:1,isA:!0};let e=+this.cardNum;return{score:isNaN(e)?10:e,isA:!1}}toString(){return this.cardNum}}const y=["diamond","clover","spade","heart"],v={diamond:"\u2666\uFE0F",clover:"\u2663\uFE0F",spade:"\u2660",heart:"\u2665"},E={diamond:"red",clover:"black",spade:"black",heart:"red"};class k{constructor(e){r(this,"shape");this.shape=e}toString(){return v[this.shape]}color(){return E[this.shape]}}class m{constructor(e,t,s="front"){r(this,"shape");r(this,"num");r(this,"side");r(this,"element");this.num=t,this.shape=e,this.side=s,this.element=document.createElement("div"),this.element.classList.add("card"),this.element.classList.add(this.shape.color()),this.element.classList.add("backAnimation"),this.element.innerText="",this.element.classList.add("back"),setTimeout(()=>this.setSide(s),1)}setSide(e){this.side=e,e==="back"?(this.element.classList.add("backAnimation"),setTimeout(()=>{this.element.innerText="",this.element.classList.add("back")},150)):(this.element.classList.remove("backAnimation"),setTimeout(()=>{this.element.classList.remove("back"),this.element.innerText=`${this.shape}
${this.num}`},150))}static genRandom(e="front"){const t=y[Math.floor(Math.random()*y.length)],s=p[Math.floor(Math.random()*p.length)];return new m(new k(t),new L(s),e)}get score(){return this.num.score()}}class b{constructor(e){r(this,"score",0);r(this,"aCount",0);r(this,"cards");this.cards=new Proxy([],{set:(t,s,a)=>{var c;let i=Number(s);return isNaN(i)||(t[i]&&(this.score-=t[i].score.score,t[i].score.isA&&this.aCount--,t[i].element.remove()),(c=document.getElementById(e))==null||c.appendChild(a.element),a instanceof m&&(this.score+=a.score.score,a.score.isA&&this.aCount++)),Reflect.set(t,s,a),!0}})}draw(e="front"){this.cards.push(m.genRandom(e))}empty(){for(let e=this.cards.length-1;e>=0;e--)this.score-=this.cards[e].score.score,this.cards[e].score.isA&&this.aCount--,this.cards[e].element.remove(),this.cards.pop()}get blackJack(){return this.maxScore===21}get burst(){return this.score>21}get maxScore(){const e=Math.floor((21-this.score)/10);return Math.min(e,this.aCount)*10+this.score}}const h=700;class w{constructor(e){r(this,"_credit",0);r(this,"gameState","idle");r(this,"gameData");this.credit=e}get credit(){return this._credit}set credit(e){const t=document.getElementById("credit");t&&(t.innerHTML=`Credit
`+e),this._credit=e}start(e){var t,s,a,i;this.gameState==="idle"&&(this.gameState="playing",this.credit-=e,(t=this.gameData)==null||t.player.empty(),(s=this.gameData)==null||s.dealer.empty(),this.gameData={bet:e,dealer:new b("dealerCards"),player:new b("playerCards")},(a=document.getElementById("burstMessage"))==null||a.classList.add("hidden"),(i=document.getElementById("message"))==null||i.classList.add("hidden"),this.gameData.dealer.draw("back"),this.gameData.dealer.draw(),this.gameData.player.draw(),this.gameData.player.draw(),this.gameData.player.blackJack&&(this.gameData.dealer.blackJack?this.dealerTurn():this.end("player",1.5)))}hit(){this.gameState!=="playing"||!this.gameData||(this.gameData.player.draw(),this.gameData.player.burst&&this.burst())}burst(){this.gameState!=="playing"||!this.gameData||(this.gameState="ended",setTimeout(()=>{this.burstMessage("You Bursted!"),this.end("dealer")},500))}stay(){this.gameState!=="playing"||!this.gameData||(this.gameState="ended",this.dealerTurn())}doubleDown(){if(this.gameState!=="playing"||!this.gameData)return;this.credit+=this.gameData.bet,this.gameData.bet+=Math.min(this.credit-this.gameData.bet,this.gameData.bet);const e=document.getElementById("betAmount");e&&(e.value=this.gameData.bet+""),this.credit-=this.gameData.bet,this.hit(),this.gameState="ended",setTimeout(()=>this.dealerTurn(),h)}dealerTurn(){this.gameState!=="ended"||!this.gameData||(this.gameData.dealer.cards[0].setSide("front"),setTimeout(()=>this.openDealer(),h))}openDealer(){this.gameState!=="ended"||!this.gameData||(this.gameData.dealer.burst?(this.burstMessage("Dealer Bursted!"),this.end("player")):this.gameData.dealer.maxScore<=16?(this.gameData.dealer.draw(),setTimeout(()=>this.openDealer(),h)):this.gameData.dealer.maxScore===this.gameData.player.maxScore?this.end("draw"):this.gameData.dealer.maxScore<this.gameData.player.maxScore?this.end("player"):this.end("dealer"))}end(e,t=1){if(this.gameState==="idle"||!this.gameData)return;this.message({dealer:"You lost!",player:"You won!",draw:"Draw"}[e],{dealer:"lose",player:"win",draw:"normal"}[e]),e==="player"&&(this.credit+=(1+t)*this.gameData.bet),e==="draw"&&(this.credit+=this.gameData.bet),this.gameState="idle";const s=document.getElementById("betAmount");s&&(s.value="",s.readOnly=!1)}message(e,t){const s=document.getElementById("message");!s||(s.innerText=e,s.classList.remove("hidden","burst","win","lose","normal"),s.classList.add(t))}burstMessage(e){const t=document.getElementById("burstMessage");t&&(t.innerText=e),t==null||t.classList.remove("hidden")}}let l=new w(100);const n=document.getElementById("startButton"),o=document.getElementById("betAmount");o==null||o.addEventListener("input",()=>{l.gameState!=="idle"||+o.value>l.credit||+o.value<=0?n==null||n.classList.add("disabled"):n==null||n.classList.remove("disabled")});o&&(n==null||n.addEventListener("click",()=>{n.classList.contains("disabled")||(n.classList.add("disabled"),o.readOnly=!0,l.start(+o.value))}));const u=document.getElementById("hitButton");u==null||u.addEventListener("click",()=>l.hit());const g=document.getElementById("stayButton");g==null||g.addEventListener("click",()=>l.stay());const f=document.getElementById("doubleDownButton");f==null||f.addEventListener("click",()=>l.doubleDown());
